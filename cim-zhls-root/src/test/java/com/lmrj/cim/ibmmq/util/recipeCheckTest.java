package com.lmrj.cim.ibmmq.util;

import com.lmrj.cim.CimZhlxMain;
import com.lmrj.rms.recipe.entity.TRXO;
import com.lmrj.rms.recipe.service.IRmsRecipeBodyService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = CimZhlxMain.class)
public class recipeCheckTest {

    @Autowired
    private IRmsRecipeBodyService rmsRecipeBodyService;

    @Test
    public void recipeCheckTest() {
        String str = "TXR01IEpi\\691485201ASN3SEE5.rcp                                                                           23THKN01  64   [EPI]                                                                                               Active=false                                                                                         Epi Algorithm=1                                                                                     Reference Thickness=19                                                                              Centerburst Exclusion Window=0.5                                                                    Early Peak Type=2                                                                                   Late Peak Type=1                                                                                    Epi Minimum Sideburst Height=0.0080                                                                 Reference Sideburst Exclusion Window=0.95                                                           Epi Window Thickness=2                                                                              Normal Mode Asymmetric Thickness=2                                                                  Index of Refraction=3.42                                                                            High Mean Limit=70                                                                                  Low Mean Limit=0                                                                                    High Sample Limit=70                                                                                Low Sample Limit=0                                                                                  ROV Type=0                                                                                          High ROV Limit=100                                                                                  Low ROV Limit=-100                                                                                  High Center Point Limit=70                                                                          Low Center Point Limit=0                                                                            Pass Fail Method=2                                                                                  Correlate Epi Measurements=FALSE                                                                    Epi Correlation Constant Term=0                                                                     Epi Correlation Linear Term=1                                                                       Epi Correlation Quadratic Term=0                                                                    Pattern Name=C:\\Program Files\\Accent\\Patterns\\13P EE3 EPI test .pat                                 Reference Name=D:\\Data\\Ref\\EPI_Ntype_ref_20200416_ref19.csv                                         Secondary Flat Depth=0.75                                                                           Save Interferogram=TRUE                                                                             Save Results=TRUE                                                                                   Resolution=8                                                                                        Scans=2                                                                                             Collect Sensitivity=1                                                                               Scan Speed=5                                                                                        Filter=1.2                                                                                          Aperture=2                                                                                          Symmetry=SYM                                                                                        Detector=0                                                                                          Detector2=INT2                                                                                      Beam=0                                                                                              Delay Before First Point=0                                                                          Delay Between Points=0                                                                              IRSource=SRC1                                                                                       Epi Thin Break Point 1=400                                                                          Epi Thin Break Point 2=800                                                                          Epi Thin Break Point 3=2600                                                                         Epi Thin Break Point 4=2800                                                                         Move Down=FALSE                                                                                     RS2000 Analysis=FALSE                                                                               FNC_Interferogram=070805040102                                                                      FNC_Result=070805040102                                                                             Rename Old Reference=1                                                                              Interferograms Folder=D:\\Data\\Spectrum collection\\EPI_Ntype\\                                        __Special Alignment=0                                                                               __Pass Fail Mean=TRUE                                                                               __Pass Fail Center=FALSE                                                                            __Pass Fail Sample=FALSE                                                                            __Pass Fail ROV=FALSE                                                                               __Pass Fail PassCount=FALSE                                                                         __Sample Pass Count=1                                                                               __Perform Spectrometer Auto Alignment=FALSE                                                         __Spectrometer GRR=40                                                                               [Sorting stations]                                                                                                                                                                                                                                                                                                                      ";
        String eqpId = str.substring(106,116).trim();
        String recipeCode = str.substring(6,106).trim();

        String recipeBodySize = str.substring(116,121);
        String recipeBody = str.substring(121);
        TRXO trxo = rmsRecipeBodyService.checkRecipeBody(eqpId, recipeCode, recipeBody, recipeBodySize);//增加加入日志表功能

        String replyMsg = trxo.getTrxId() + trxo.getTypeId() + trxo.getResult() + trxo.getMsg();
        System.out.println(replyMsg);
    }
}
